
== Purpose ==
This is a bunch of tools chained together to provide a JSON object that represents various pieces of a malicious PDF file. 

== Research == 
http://blog.9bplus.com

== Usage ==
Usage: object_builder.py [options]
Builds JSON object representing a malicious PDF

Options:
  --version             show program's version number and exit
  -h, --help            show this help message and exit
  -f FILE, --file=FILE  file to build an object from
  -d DIR, --dir=DIR     dir to build an object from
  -m, --mongo           dump to a mongodb database
  -v, --verbose         verbose outpout

== Sample Output == 
{
	"scans": {
		"wepawet": "null", 
		"virustotal": {
			"report": [
				"2010-12-11 16:51:35", 
				{
					"nProtect": "Exploit.PDF-Name.Gen", 
					"CAT-QuickHeal": "", 
					"McAfee": "", 
					"TheHacker": "", 
					"K7AntiVirus": "", 
					"VirusBuster": "", 
					"NOD32": "PDF/Exploit.Gen", 
					"F-Prot": "JS/ShellCode.AX.gen", 
					"Symantec": "Bloodhound.Exploit.213", 
					"Norman": "PDF/Suspicious.D", 
					"TrendMicro-HouseCall": "JS_UTOTI.OB", 
					"Avast": "JS:Pdfka-AK", 
					"eSafe": "PDF.Exploit", 
					"ClamAV": "Heuristics.PDF.ObfuscatedNameObject", 
					"Kaspersky": "Exploit.JS.Pdfka.cil", 
					"BitDefender": "Exploit.PDF-JS.Gen", 
					"SUPERAntiSpyware": "", 
					"Emsisoft": "Exploit.JS.Pdfka!IK", 
					"Comodo": "UnclassifiedMalware", 
					"F-Secure": "Exploit.PDF-JS.Gen", 
					"DrWeb": "", 
					"VIPRE": "Exploit.PDF-JS.Gen (v)", 
					"AntiVir": "EXP/PDF.JS.6378", 
					"TrendMicro": "JS_UTOTI.OB", 
					"McAfee-GW-Edition": "Heuristic.BehavesLike.PDF.Suspicious.F", 
					"Sophos": "Troj/PDFJs-B", 
					"eTrust-Vet": "PDF/Pidief.TD", 
					"Jiangmin": "", 
					"Command": "", 
					"Antiy-AVL": "", 
					"Microsoft": "TrojanDownloader:Win32/Small.gen!C", 
					"ViRobot": "", 
					"Prevx": "", 
					"GData": "Exploit.PDF-JS.Gen", 
					"AhnLab-V3": "PDF/Exploit-script", 
					"VBA32": "Exploit.JS.Pdfka.cil", 
					"PCTools": "HeurEngine.MaliciousExploit", 
					"Rising": "", "Ikarus": "Exploit.JS.Pdfka", 
					"Fortinet": "", 
					"AVG": "", 
					"Panda": "", 
					"Avast5": "JS:Pdfka-AK"
				}
			], 
			"permalink": "http://www.virustotal.com/file-scan/report.html?id=eb7d1c351d81a619988ab907fd664aeb4b175a84c45378f405c1102810194980-1292086295", 
			"result": 1
		}
	},
	 
	"structure": {
		"countChatAfterLastEof": "0", 
		"errorMessage": "", 
		"dates": {
			"date": []
		}, 
		"filename": "../../PDFs/files/fe53357e06be3644d535133cbee3dd67.pdf.vir", 
		"nonStreamEntropy": "4.916826", 
		"header": "%PDF-1.5", 
		"version": "0.0.11", 
		"entropy": "", 
		"totalEntropy": "7.886452", 
		"isPdf": "True", 
		"keywords": {
			"keyword": [
				{"count": 6, "hexcodecount": 0, "name": "obj"}, 
				{"count": 6, "hexcodecount": 0, "name": "endobj"}, 
				{"count": 1, "hexcodecount": 0, "name": "stream"}, 
				{"count": 1, "hexcodecount": 0, "name": "endstream"}, 
				{"count": 1, "hexcodecount": 0, "name": "xref"}, 
				{"count": 1, "hexcodecount": 0, "name": "trailer"}, 
				{"count": 1, "hexcodecount": 0, "name": "startxref"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Page"}, 
				{"count": 0, "hexcodecount": 0, "name": "/Encrypt"}, 
				{"count": 0, "hexcodecount": 0, "name": "/ObjStm"}, 
				{"count": 1, "hexcodecount": 0, "name": "/JS"}, 
				{"count": 1, "hexcodecount": 1, "name": "/JavaScript"}, 
				{"count": 0, "hexcodecount": 0, "name": "/AA"}, 
				{"count": 1, "hexcodecount": 1, "name": "/OpenAction"}, 
				{"count": 0, "hexcodecount": 0, "name": "/AcroForm"}, 
				{"count": 0, "hexcodecount": 0, "name": "/JBIG2Decode"}, 
				{"count": 0, "hexcodecount": 0, "name": "/RichMedia"}, 
				{"count": 0, "hexcodecount": 0, "name": "/Launch"}, 
				{"count": 0, "hexcodecount": 0, "name": "/Colors > 2^24"}, 
				{"count": 2, "hexcodecount": 0, "name": "/4"}, 
				{"count": 1, "hexcodecount": 0, "name": "/7kD"}, 
				{"count": 1, "hexcodecount": 1, "name": "/ASCIIHexDecode"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Action"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Catalog"}, 
				{"count": 2, "hexcodecount": 2, "name": "/Count"}, 
				{"count": 1, "hexcodecount": 0, "name": "/D"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Filter"}, 
				{"count": 1, "hexcodecount": 1, "name": "/FlateDecode"}, 
				{"count": 1, "hexcodecount": 0, "name": "/J2"}, 
				{"count": 1, "hexcodecount": 0, "name": "/K"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Kids"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Length"}, 
				{"count": 1, "hexcodecount": 1, "name": "/MediaBox"}, 
				{"count": 1, "hexcodecount": 0, "name": "/Nw"}, 
				{"count": 2, "hexcodecount": 2, "name": "/Outlines"}, 
				{"count": 2, "hexcodecount": 2, "name": "/Pages"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Parent"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Root"}, 
				{"count": 1, "hexcodecount": 1, "name": "/S"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Size"}, 
				{"count": 5, "hexcodecount": 5, "name": "/Type"}, 
				{"count": 1, "hexcodecount": 0, "name": "/d"}, 
				{"count": 1, "hexcodecount": 0, "name": "/g"}, 
				{"count": 1, "hexcodecount": 0, "name": "/j2U"}
			]
		}, 
		"countEof": "1", 
		"streamEntropy": "7.959980", 
		"errorOccured": "False"
	}, 
	
	"hash_data": {
		"hashes": {
			"objects": {
				"object": [
					{"length": 89, "version": 0, "id": 1, "md5": "b60c8c6827aa107d7266fe4a974029c0"}, 
					{"length": 46, "version": 0, "id": 2, "md5": "8511ab96e6ff067fa6cecf1aa6c5f0d4"}, 
					{"length": 51, "version": 0, "id": 3, "md5": "0f71cc95d7e3c7ca6463519443d42b26"}, 
					{"length": 73, "version": 0, "id": 4, "md5": "bfaf964ecde2bc56534e3d3ce0edc6bd"}, 
					{"length": 56, "version": 0, "id": 5, "md5": "b5b9672d521e94256cd1cccf33cec78c"}, 
					{"length": 5742, "version": 0, "id": 6, "md5": "04cba0f9a1d2d8914ff013df552cee1f"}
				]
			}, 
			"file": {
				"sha256": "eb7d1c351d81a619988ab907fd664aeb4b175a84c45378f405c1102810194980", 
				"md5": "fe53357e06be3644d535133cbee3dd67", 
				"sha1": "bada2624083632a9660f466a1a6ef702472f0b18"
			}
		}
	}, 
	
	"scores": {
		"total": "5", 
		"primary": "5", 
		"seconday": "0"
	}
}

